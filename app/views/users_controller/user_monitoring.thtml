<html> 
<head>
<script type="text/javascript" src="<?=ROOT_URL;?>/app/webroot/js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="<?=ROOT_URL;?>/app/webroot/js/bria_api_constants.js"></script>
<script type="text/javascript" src="<?=ROOT_URL;?>/app/webroot/js/bria_api_js_sample.js"></script>
<link rel="stylesheet" type="text/css" media="all" href="<?=ROOT_URL;?>/app/webroot/css/store_tree.css" />
<link rel="stylesheet" type="text/css" media="all" href="<?=ROOT_URL;?>/app/webroot/css/ui-smooth/jquery-ui-1.8.13.custom.css" />
 <style type="text/css">
   table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
th, td {
  padding: 5px;
  text-align: left;    
}
.table-class {
  width: 100%;
  margin-top: 10px;
}
</style> 
<script type="text/javascript">
  jQuery( document ).ready(function($) {
  
  $(".listen-call").on("click", function(e) {
      e.preventDefault();  
      var extId = $(this).attr("ext_id");
      bringToFront();
      placeCall('*83'+extId);
  });
   
    $(".training-call").on("click", function(e) {
      e.preventDefault();  
      var extId = $(this).attr("ext_id");
       bringToFront();
      placeCall('*82'+extId);
    });
   $(".barging-call").on("click", function(e) {
      e.preventDefault();  
      var extId = $(this).attr("ext_id");
      bringToFront();
      placeCall('*81'+extId);
    });

    $('.logout ').on('change', function(){
        var userId = $(this).val();
        logoutUser(userId);  
    });

    $('#logoutAll').on('change', function(){
        var userId = '';
        $(".logout").each(function(){
            userId += (userId != "")? "," : "";
            userId += $(this).val();
        });
        logoutUser(userId);
    });
});
  
  function logoutUser(userId)
  {
      jQuery.ajax({
      url: "<?=BASE_URL;?>/login/logoutByAdmin",
      type: "POST",
      data: {id : userId},
      success: function(data){
        location.href = "<?=BASE_URL;?>/users/userMonitoring";
      }
    });
  }
</script>

</head>
<body>
  
  <form name="user-monitoring" action="" method="post" enctype="multipart/form-data">
   
    <table  class="table-class" align="left" border="0" cellspacing="1" cellpadding="0"> 
     <th>Position</th>
     <th>Name</th>
     <th>Extension</th>
     <th>Status</th>  
     <th> <input id="logoutAll" type="checkbox" name=""> Logout</th> 
    <?php foreach($users as $user) {
      ?>
    <tr>
      <td><?php echo $user['name'] ?></td>
       <td><?php echo $user['first_name'] ?></td>
       <td><?php echo $user['extension_id'] ?></td> 
       <td><input type="button" class="listen-call" name="Listen" value="Listen" ext_id="<?php echo $user['extension_id'] ?>"> <input type="button" class="training-call" name="Training" value="Training" ext_id="<?php echo $user['extension_id'] ?>"> <input type="button" class="barging-call" name="Barging" value="Barging" ext_id="<?php echo $user['extension_id'] ?>">
       </td>
       <td><input class="logout" type="checkbox" name="logout" value="<?=$user['id']?>"></td> 
    </tr>
   
  <?php }?>
</table>
</form>
</body>
</html>