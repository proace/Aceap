<script type="text/javascript" src="<?=ROOT_URL;?>/app/webroot/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
	$(".edit_button").each(function(){
		$(this).removeAttr("disabled");
	});
		
	$(".delete_button").click(function(){		
		var v = $(this).parents(".editrow").find("#CityName").val();		
		if(confirm("Are you sure you want to delete " + v + "?")) {			
			$(this).next("#CityDelete").val(1);			
			return true;	
		} else {
			return false;	
		}
	});
	
	$(".edit_button").click(function(){	
		$(this).parents(".datarow").hide();
		$(this).parents(".datarow").next(".editrow").show();
		$(".edit_button").each(function(){
			$(this).attr("disabled", true);
		});
	});
	
	$(".cancel_button").click(function(){
		$(this).parents(".editrow").hide();		
		$(this).parents(".editrow").prev(".datarow").show();
		$(".edit_button").each(function(){
			$(this).removeAttr("disabled");
		});
	});
	
	$(".datarow:odd").addClass("cell1");
});
</script>
<style>
.editrow {
	background-color:#99ffcc;
	display:none;
}

tr>:first-child {
	background-color:#888888;
	border-style:none;
}

.results {
	border:1px solid #cccccc;
}

</style>
<div>
<h1>Cities</h1>
<?php if($message != "") { ?>
<div style="border:2px solid #bedf5d;font-size:12px;padding:2px;padding-left:10px;background:#e5f2be"><?php echo $message; ?></div>
<?php } ?>
<form action="<?php echo BASE_URL ?>/cities/save" method="post">
</form>
<table class="results cell0" cellspacing="0">
	<form action="<?php echo BASE_URL ?>/cities/save" method="post">
    <tr class="datarow newrow">
    	<td colspan="6"><input class="edit_button" type="button" value="Add" style="width:50px" /></td>
    </tr>
    <tr class="editrow" style="display:none;">
    	<td></td>
		<td><?php echo $html->input('City/name'); ?></td>
		<td>
        	<?php echo $html->input('City/id'); ?>
		</td>
        <td>
        	<?php echo $html->input('City/code', array("maxlength"=>2)); ?>
		</td>
        <td align="center">
        	<?php echo $html->input('City/active',array("value"=>1, "type"=>"checkbox", "checked"=>true, "disabled"=>true)); ?>
        </td>        
		<td>        
		<input class="save_button" type="submit" value="Save" style="width:50px" />
        <input class="cancel_button" type="button" value="Cancel" style="width:50px" />
		</td>
	</tr>	
	<tr>  
		<th>Internal Id</th>  
		<th>Name</th>
		<th>Id</th>
        <th>Code</th>
        <th>Active</th>
		<th></th>
	</tr>    
    </form> 
	<?php foreach ($cities as $city) { ?>
    <form action="<?php echo BASE_URL ?>/cities/save" method="post">  
	<tr class="datarow">
		<td align="center">
			<?php echo $html->input('City/internal_id',array("value"=>$city['City']['internal_id'], "type"=>"hidden")); ?>
			<?php echo $city['City']['internal_id']; ?>
		</td>
		<td><?php echo $city['City']['name']; ?></td>
		<td>
        	<?php echo $html->input('City/id',array("value"=>$city['City']['id'], "type"=>"hidden")); ?>
			<?php echo $city['City']['id']; ?>
		</td>
        <td>
        	<?php echo $html->input('City/code',array("value"=>$city['City']['code'], "type"=>"hidden")); ?>
			<?php echo $city['City']['code']; ?>
		</td>
        <td align="center">
        	<?php echo $html->input('City/active',array("value"=>1, "type"=>"checkbox", "checked"=>$city['City']['active']?true:false, "disabled"=>true)); ?>
		</td>
		<td>
        <input class="edit_button" type="button" value="Edit" style="width:50px" />
		</td>
	</tr>
    <tr class="editrow">
		<td align="center">
			<?php echo $html->input('City/internal_id',array("value"=>$city['City']['internal_id'], "type"=>"hidden")); ?>
			<?php echo $city['City']['internal_id']; ?>
		</td>
		<td><?php echo $html->input('City/name',array("value"=>$city['City']['name'])); ?></td>
		<td>
        	<?php echo $html->input('City/id',array("value"=>$city['City']['id'], "type"=>"hidden")); ?>
			<?php echo $city['City']['id']; ?>
		</td>
        <td>
        	<?php echo $html->input('City/code',array("value"=>$city['City']['code'], "type"=>"hidden")); ?>
			<?php echo $city['City']['code']; ?>
		</td>
        <td align="center">
        	<?php echo $html->input('City/active',array("value"=>1, "type"=>"checkbox", "checked"=>$city['City']['active']?true:false)); ?>
		</td>
		<td>        
		<input class="save_button" type="submit" value="Save" style="width:50px" />
        <input class="cancel_button" type="button" value="Cancel" style="width:50px" />
        <input class="delete_button" type="submit" value="X" style="width:20px" />
        <?php echo $html->input('City/delete',array("value"=>0, "type"=>"hidden")); ?>
        
		</td>
	</tr>
    </form>
	<?php } //end foreach cities ?>
</table>
</div>